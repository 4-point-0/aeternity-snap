<!DOCTYPE html>
<html>
  <head>
    <title>Hello, Aeternity snap!</title>
  </head>
  <body>
    <h1>Hello, Aeternity snap!</h1>

    <button class="connect">Connect</button>
    <button class="signTransactionButton">Sign transaction</button>
    <button class="getPubkey">Get public key</button>
    <button class="sign">Sign message</button>

    <script>
      const snapId = `local:${window.location.href}`;

      const connectButton = document.querySelector("button.connect");
      const signTransactionButton = document.querySelector(
        "button.signTransactionButton"
      );
      const getPubkeyButton = document.querySelector("button.getPubkey");
      const signButton = document.querySelector("button.sign");

      connectButton.addEventListener("click", connect);
      signTransactionButton.addEventListener("click", signTransaction);
      getPubkeyButton.addEventListener("click", getPubkey);
      signButton.addEventListener("click", sign);

      async function connect() {
        await ethereum.request({
          method: "wallet_requestSnaps",
          params: { [snapId]: {} },
        });
      }

      async function getPubkey() {
        try {
          const response = await ethereum.request({
            method: "wallet_invokeSnap",
            params: {
              snapId,
              request: {
                method: "getPublicKey",
                params: {
                  derivationPath: [`0'`, `0'`, `0'`],
                  confirm: true,
                },
              },
            },
          });
          console.log(response);
        } catch (err) {
          console.error(err);
          alert("Problem happened: " + err.message || err);
        }
      }

      async function sign() {
        try {
          const response = await ethereum.request({
            method: "wallet_invokeSnap",
            params: {
              snapId,
              request: {
                method: "signMessage",
                params: {
                  derivationPath: [`0'`, `0'`, `0'`],
                  message: "QWV0ZXJuaXR5IG1lc3NhZ2Ugc2lnbmluZyE=",
                },
              },
            },
          });
          console.log(response);
        } catch (err) {
          console.error(err);
          alert("Problem happened: " + err.message || err);
        }
      }

      async function signTransaction() {
        try {
          const response = await window.ethereum.request({
            method: "wallet_invokeSnap",
            params: {
              snapId,
              request: {
                method: "signTransaction",
                params: {
                  derivationPath: [`0'`, `0'`, `0'`],
                  message: "QWV0ZXJuaXR5IG1lc3NhZ2Ugc2lnbmluZyE=",
                },
              },
            },
          });
          console.log(response);
        } catch (err) {
          console.error(err);
          alert("Problem happened: " + err.message || err);
        }
      }
    </script>
  </body>
</html>
